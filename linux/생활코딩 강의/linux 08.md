## linux 08 - rsync, ssh key, 연속 명령 실행시키기

##### 2018-12-09

---

### rsync

* **인터넷을 통한 서버간 동기화**
* **remote sync**의 약자
* **네트워크 원격으로 동기화 가능**
* 메뉴얼 참고

```bash
rsync 옵션 소스 목적지

# a는 아카이브 z는 압축해서 P는 프로그레스바 표시
rsync -azP 내경로디렉토리 유저명@아이피:목적지디렉토리
```

---

### 로그인 없이 로그인하기 (ssh key)

* 공개키 방식으로 자동로그인(더 안전한) 구현

```bash
# 이렇게 하면 공개키방식의 key를 저장
ssh-keygen
```

![01](https://github.com/younggeun0/TIL/blob/master/linux/%EC%83%9D%ED%99%9C%EC%BD%94%EB%94%A9%20%EA%B0%95%EC%9D%98/img/08/01.png?raw=true)


* **id_rsa는 비밀키, id_rsa.pub이 공개키**

```bash
ssh-copy-id 로그인하고자하는컴퓨터@아이피
```

* **자동으로 접속하는 컴퓨터의 authorized keys 내용에 추가됨(key가 추가됨)**
* 공개키가 상대컴에 전달되고 이제 비밀키 들고 가면 바로 로그인 되는 것
* **이걸 설정하면 rsync일때도 인증관계가 필요없음(로그인 없이)**
    * 또 crone과 같은 기능을 이용할때 로그인해야하면 자동화할 수 없음
        * 정기적인 작업(백업)을 자동화 가능

---

### 연속 명령 실행시키기 

* **CLI의 가치는 순서대로 배치해서 자동화처리가 가능하다는 것.**

```bash
# ; - 앞의 명령어가 실패해도 다음 명령어 실행(성공과 무관하게 진행)
# && - 앞의 명령어가 성공했을 때 다음 명령어 실행
# & - 앞의 명령어를 백그라운드로 돌리고 동시에 뒤의 명령어 실행

# 바로 전 명령어의 성공여부를 반환하는 명령어
echo $?

# 성공은 0, 실패는 1, 존재하지 않는 명령어는 127, 실패는 0이 아닌 값이 나온다!
```

* **명령의 그룹핑 {}**

```bash
mkdir test3 && { cd test3; touch abc; echo 'success!!' } || echo 'There is no dir';
```

---

### 자료 출처

[생활코딩 리눅스](https://opentutorials.org/course/2598)
